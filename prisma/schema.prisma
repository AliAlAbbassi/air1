generator client {
  provider = "prisma-client-py"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ============================================================================
// HODHOD ONBOARDING MODELS
// ============================================================================

model HodhodUser {
  id               BigInt             @id @default(autoincrement())
  email            String             @unique @db.VarChar(255)
  firstName        String             @map("first_name") @db.VarChar(255)
  lastName         String             @map("last_name") @db.VarChar(255)
  fullName         String?            @map("full_name") @db.VarChar(255)
  passwordHash     String?            @map("password_hash")
  authMethod       String             @map("auth_method") @db.VarChar(50)
  timezone         String?            @db.VarChar(50)
  meetingLink      String?            @map("meeting_link")
  linkedinConnected Boolean           @default(false) @map("linkedin_connected")
  createdOn        DateTime           @default(now()) @map("created_on") @db.Timestamp(6)
  updatedOn        DateTime           @default(now()) @updatedAt @map("updated_on") @db.Timestamp(6)
  
  companies        HodhodCompany[]
  products         HodhodProduct[]
  writingStyles    HodhodWritingStyle[]

  @@map("hodhod_user")
}

model HodhodCompany {
  id            BigInt          @id @default(autoincrement())
  userId        BigInt          @map("user_id")
  name          String          @db.VarChar(255)
  description   String?
  website       String?         @db.VarChar(255)
  industry      String?         @db.VarChar(255)
  linkedinUrl   String?         @map("linkedin_url")
  employeeCount String?         @map("employee_count") @db.VarChar(50)
  logo          String?
  createdOn     DateTime        @default(now()) @map("created_on") @db.Timestamp(6)
  updatedOn     DateTime        @default(now()) @updatedAt @map("updated_on") @db.Timestamp(6)
  
  user          HodhodUser      @relation(fields: [userId], references: [id], onDelete: Cascade)
  products      HodhodProduct[]

  @@map("hodhod_company")
}

model HodhodProduct {
  id                   BigInt        @id @default(autoincrement())
  userId               BigInt        @map("user_id")
  companyId            BigInt        @map("company_id")
  name                 String        @db.VarChar(255)
  url                  String?
  description          String?
  idealCustomerProfile String?       @map("ideal_customer_profile")
  competitors          String?
  createdOn            DateTime      @default(now()) @map("created_on") @db.Timestamp(6)
  updatedOn            DateTime      @default(now()) @updatedAt @map("updated_on") @db.Timestamp(6)
  
  user                 HodhodUser    @relation(fields: [userId], references: [id], onDelete: Cascade)
  company              HodhodCompany @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@map("hodhod_product")
}

model HodhodWritingStyle {
  id               BigInt     @id @default(autoincrement())
  userId           BigInt     @map("user_id")
  selectedTemplate String?    @map("selected_template") @db.VarChar(255)
  dos              String[]
  donts            String[]
  createdOn        DateTime   @default(now()) @map("created_on") @db.Timestamp(6)
  updatedOn        DateTime   @default(now()) @updatedAt @map("updated_on") @db.Timestamp(6)
  
  user             HodhodUser @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("hodhod_writing_style")
}

// ============================================================================
// EXISTING MODELS
// ============================================================================

model Lead {
  leadId          BigInt            @id @default(autoincrement()) @map("lead_id")
  firstName       String?           @map("first_name") @db.VarChar(255)
  fullName        String?           @map("full_name") @db.VarChar(255)
  email           String?           @unique @db.VarChar(255)
  phoneNumber     String?           @map("phone_number") @db.VarChar(255)
  createdOn       DateTime          @default(now()) @map("created_on") @db.Timestamp(6)
  updatedOn       DateTime          @default(now()) @updatedAt @map("updated_on") @db.Timestamp(6)
  contact_point   contact_point[]
  linkedinProfile LinkedinProfile[]

  @@map("lead")
}

model LinkedinProfile {
  linkedinProfileId  BigInt                  @id @default(autoincrement()) @map("linkedin_profile_id")
  leadId             BigInt?                 @map("lead_id")
  username           String                  @unique @db.VarChar(255)
  location           String?
  headline           String?
  about              String?
  createdOn          DateTime                @default(now()) @map("created_on") @db.Timestamp(6)
  updatedOn          DateTime                @default(now()) @updatedAt @map("updated_on") @db.Timestamp(6)
  companyMemberships LinkedinCompanyMember[]
  lead               Lead?                   @relation(fields: [leadId], references: [leadId], onDelete: NoAction, onUpdate: NoAction)

  @@index([headline(ops: raw("gin_trgm_ops"))], map: "idx_linkedin_profile_headline_gin", type: Gin)
  @@index([leadId], map: "idx_linkedin_profile_lead_id")
  @@index([username], map: "idx_linkedin_profile_username_btree")
  @@map("linkedin_profile")
}

model LinkedinCompanyMember {
  companyMemberId   BigInt           @id @default(autoincrement()) @map("company_member_id")
  linkedinProfileId BigInt?          @map("linkedin_profile_id")
  username          String           @db.VarChar(255)
  title             String?          @db.VarChar(255)
  createdOn         DateTime         @default(now()) @map("created_on") @db.Timestamp(6)
  updatedOn         DateTime         @default(now()) @updatedAt @map("updated_on") @db.Timestamp(6)
  joined_at         DateTime?        @db.Date
  linkedinProfile   LinkedinProfile? @relation(fields: [linkedinProfileId], references: [linkedinProfileId], onDelete: NoAction, onUpdate: NoAction)

  @@unique([linkedinProfileId, username], map: "unique_profile_company")
  @@map("linkedin_company_members")
}

model alembic_version {
  version_num String @id(map: "alembic_version_pkc") @db.VarChar(32)
}

model contact_point {
  contact_point_id      BigInt               @id @default(autoincrement())
  lead_id               BigInt?
  contact_point_type_id BigInt?
  created_on            DateTime             @default(now()) @db.Timestamp(6)
  updated_on            DateTime             @default(now()) @db.Timestamp(6)
  contact_point_types   contact_point_types? @relation(fields: [contact_point_type_id], references: [contact_point_types_id], onDelete: NoAction, onUpdate: NoAction)
  lead                  Lead?                @relation(fields: [lead_id], references: [leadId], onDelete: NoAction, onUpdate: NoAction)
}

model contact_point_types {
  contact_point_types_id BigInt          @id @default(autoincrement())
  contact_point_type     String          @db.VarChar(255)
  created_on             DateTime        @default(now()) @db.Timestamp(6)
  updated_on             DateTime        @default(now()) @db.Timestamp(6)
  contact_point          contact_point[]
}
